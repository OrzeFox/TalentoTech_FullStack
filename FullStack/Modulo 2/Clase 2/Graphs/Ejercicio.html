<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Transmilenio - Modelo Pedagógico</title>
    <style>
        /* Estilos CSS (sin cambios) */
    </style>
</head>
<body>
<h1>Red Transmilenio - Modelo Pedagógico</h1>

<!-- Formulario para crear una nueva estación (sin cambios) -->

<!-- Tabla para mostrar y editar conexiones entre estaciones (sin cambios) -->

<!-- Sección para encontrar la ruta óptima (sin cambios) -->

<script>
    class Grafo {
        constructor() {
            this.nodos = new Map();
            this.aristas = new Map();
        }

        agregarNodo(id, info) {
            if (!this.nodos.has(id)) {
                this.nodos.set(id, info);
                this.aristas.set(id, new Map());
                return true;
            }
            return false;
        }

        eliminarNodo(id) {
            if (this.nodos.has(id)) {
                this.nodos.delete(id);
                this.aristas.delete(id);
                for (let [, conexiones] of this.aristas) {
                    conexiones.delete(id);
                }
                return true;
            }
            return false;
        }

        agregarArista(id1, id2, peso, dirigida = false) {
            if (this.nodos.has(id1) && this.nodos.has(id2)) {
                this.aristas.get(id1).set(id2, peso);
                if (!dirigida) {
                    this.aristas.get(id2).set(id1, peso);
                }
                return true;
            }
            return false;
        }

        obtenerNodos() {
            return Array.from(this.nodos.keys());
        }

        obtenerVecinos(id) {
            return Array.from(this.aristas.get(id).keys());
        }

        obtenerPeso(id1, id2) {
            return this.aristas.get(id1).get(id2);
        }

        obtenerMatrizAdyacencia() {
            const nodos = this.obtenerNodos();
            const matriz = [];
            for (let i = 0; i < nodos.length; i++) {
                matriz[i] = [];
                for (let j = 0; j < nodos.length; j++) {
                    matriz[i][j] = this.obtenerPeso(nodos[i], nodos[j]) || 0;
                }
            }
            return matriz;
        }

        obtenerListaAdyacencia() {
            const lista = {};
            for (let nodo of this.nodos.keys()) {
                lista[nodo] = Array.from(this.aristas.get(nodo).entries());
            }
            return lista;
        }
    }
    class Estacion{
        constructor(id,nombre) {
            this.id=id;
            this.nombre=nombre;
        }
    }

    // Definición de la clase TransmilenioNetwork
    class TransmilenioNetwork extends Grafo {
        constructor() {
            super();
        }

        // TODO: Implementar métodos específicos para la red de Transmilenio
        // 1. Método para agregar una estación a la red
        // 2. Método para agregar una conexión entre estaciones
        // 3. Método para obtener todas las estaciones de la red
        // Tip: utilizar y extender los métodos de la clase Grafo
    }

    // Creación de la red de Transmilenio y agregado de algunas estaciones y conexiones iniciales
    const redTransmilenio = new TransmilenioNetwork();
    // TODO: Agregar algunas estaciones y conexiones de ejemplo
    // Ejemplo:
    // redTransmilenio.agregarEstacion("Portal Norte", "Portal Norte");
    // redTransmilenio.agregarConexion("Portal Norte", "Calle 100", 10);

    function actualizarInterfaz() {
        const estaciones = redTransmilenio.obtenerEstaciones();
        const selectInicio = document.getElementById('estacionInicio');
        const selectFin = document.getElementById('estacionFin');
        const tabla = document.getElementById('conexionesTable');

        selectInicio.innerHTML = '';
        selectFin.innerHTML = '';

        estaciones.forEach(estacion => {
            const optionInicio = new Option(estacion.nombre, estacion.id);
            const optionFin = new Option(estacion.nombre, estacion.id);
            selectInicio.add(optionInicio);
            selectFin.add(optionFin);
        });

        const thead = tabla.querySelector('thead tr');
        const tbody = tabla.querySelector('tbody');

        thead.innerHTML = '<th>Estación</th>';
        tbody.innerHTML = '';

        estaciones.forEach(estacion => {
            const th = document.createElement('th');
            th.textContent = estacion.nombre;
            thead.appendChild(th);
        });

        estaciones.forEach(estacionOrigen => {
            const tr = document.createElement('tr');
            const tdNombre = document.createElement('td');
            tdNombre.textContent = estacionOrigen.nombre;
            tr.appendChild(tdNombre);

            estaciones.forEach(estacionDestino => {
                const td = document.createElement('td');
                if (estacionOrigen.id !== estacionDestino.id) {
                    const input = document.createElement('input');
                    input.type = 'number';
                    input.min = '0';
                    input.dataset.origen = estacionOrigen.id;
                    input.dataset.destino = estacionDestino.id;
                    input.value = redTransmilenio.obtenerPeso(estacionOrigen.id, estacionDestino.id) || '';
                    input.addEventListener('change', (e) => {
                        const tiempo = parseInt(e.target.value);
                        if (!isNaN(tiempo)) {
                            redTransmilenio.agregarConexion(e.target.dataset.origen, e.target.dataset.destino, tiempo);
                        }
                    });
                    td.appendChild(input);
                }
                tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
    }

    document.getElementById('nuevaEstacionForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const id = document.getElementById('idEstacion').value;
        const nombre = document.getElementById('nombreEstacion').value;
        if (redTransmilenio.agregarEstacion(id, nombre)) {
            actualizarInterfaz();
            document.getElementById('idEstacion').value = '';
            document.getElementById('nombreEstacion').value = '';
        } else {
            alert('No se pudo agregar la estación. Puede que el ID ya exista.');
        }
    });

    // Implementación del algoritmo de Dijkstra para encontrar la ruta más corta
    function dijkstra(grafo, inicio, fin) {
        // TODO: Implementar el algoritmo de Dijkstra
        // 1. Inicializar las estructuras de datos necesarias
        // 2. Implementar el bucle principal del algoritmo
        // 3. Reconstruir y devolver la ruta más corta
        // Tip: Utilizar los métodos del grafo como obtenerNodos(), obtenerVecinos(), obtenerPeso()
    }

    // Función para encontrar y mostrar la ruta óptima
    function encontrarRuta() {
        // TODO: Implementar la lógica para encontrar y mostrar la ruta
        // 1. Obtener las estaciones de inicio y fin seleccionadas
        // 2. Llamar al algoritmo de Dijkstra
        // 3. Mostrar el resultado en el HTML
        // Tip: Usar document.getElementById() para obtener los valores y actualizar el resultado
    }

    // Inicializar la interfaz al cargar la página
    actualizarInterfaz();
</script>
</body>
</html>