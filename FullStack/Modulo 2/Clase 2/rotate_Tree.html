<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotación Simple a la Derecha en Árbol AVL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }

        h1 {
            margin-bottom: 20px;
        }

        #treeContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 400px;
            position: relative;
        }

        .node {
            width: 50px;
            height: 50px;
            background-color: #333;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            position: absolute;
        }

        .line {
            width: 2px;
            background-color: #333;
            position: absolute;
            transform-origin: top left;
        }

        button {
            margin: 20px;
            padding: 10px 20px;
            font-size: 16px;
        }

        #stepDescription {
            font-size: 18px;
            text-align: center;
            width: 80%;
        }

    </style>
</head>
<body>
<h1>Rotación Simple a la Derecha en Árbol AVL</h1>
<div id="treeContainer"></div>
<button onclick="rotateRightStep()">Siguiente Paso</button>
<p id="stepDescription"></p>
<script>
    const treeContainer = document.getElementById('treeContainer');
    const stepDescription = document.getElementById('stepDescription');

    const nodes = {};
    const lines = [];
    let step = 0;

    function createNode(id, x, y, label) {
        const node = document.createElement('div');
        node.className = 'node';
        node.id = id;
        node.style.left = `${x}px`;
        node.style.top = `${y}px`;
        node.textContent = label;
        treeContainer.appendChild(node);
        nodes[id] = node;
    }

    function createLine(fromNode, toNode) {
        const line = document.createElement('div');
        line.className = 'line';
        const fromRect = fromNode.getBoundingClientRect();
        const toRect = toNode.getBoundingClientRect();
        const x1 = fromRect.left + fromRect.width / 2;
        const y1 = fromRect.top + fromRect.height / 2;
        const x2 = toRect.left + toRect.width / 2;
        const y2 = toRect.top + toRect.height / 2;
        const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
        line.style.width = `${length}px`;
        line.style.transform = `rotate(${Math.atan2(y2 - y1, x2 - x1)}rad)`;
        line.style.left = `${x1}px`;
        line.style.top = `${y1}px`;
        treeContainer.appendChild(line);
        lines.push(line);
    }

    function clearLines() {
        lines.forEach(line => treeContainer.removeChild(line));
        lines.length = 0;
    }

    function rotateRightStep() {
        clearLines();
        switch (step) {
            case 0:
                stepDescription.textContent = "Paso 1: Identificamos el nodo desbalanceado (N), su hijo izquierdo (L) y el hijo derecho de L (Lr).";
                highlightNode(nodes.L);
                highlightNode(nodes.N);
                highlightNode(nodes.Lr);
                createLine(nodes.L, nodes.N);
                createLine(nodes.L, nodes.Lr);
                break;
            case 1:
                stepDescription.textContent = "Paso 2: L se convierte en la nueva raíz del subárbol.";
                nodes.L.style.top = '100px';
                nodes.L.style.left = '200px';
                nodes.N.style.top = '200px';
                nodes.N.style.left = '300px';
                createLine(nodes.L, nodes.N);
                break;
            case 2:
                stepDescription.textContent = "Paso 3: N se convierte en el hijo derecho de L.";
                nodes.Lr.style.top = '200px';
                nodes.Lr.style.left = '300px';
                nodes.L.style.top = '100px';
                nodes.L.style.left = '200px';
                nodes.N.style.top = '300px';
                nodes.N.style.left = '400px';
                createLine(nodes.L, nodes.Lr);
                createLine(nodes.L, nodes.N);
                createLine(nodes.N, nodes.Nr);
                break;
            case 3:
                stepDescription.textContent = "Paso 4: Lr se convierte en el hijo izquierdo de N.";
                nodes.Lr.style.top = '200px';
                nodes.Lr.style.left = '300px';
                nodes.N.style.top = '300px';
                nodes.N.style.left = '400px';
                nodes.L.style.top = '100px';
                nodes.L.style.left = '200px';
                createLine(nodes.L, nodes.Lr);
                createLine(nodes.L, nodes.N);
                createLine(nodes.N, nodes.Nr);
                createLine(nodes.N, nodes.Lr);
                break;
            default:
                resetNodes();
                stepDescription.textContent = "";
                step = -1;
        }
        step++;
    }

    function highlightNode(node) {
        node.style.backgroundColor = '#ff5722';
    }

    function resetNodes() {
        treeContainer.innerHTML = '';
        createNode('N', 200, 200, 'N');
        createNode('L', 100, 100, 'L');
        createNode('Lr', 200, 300, 'Lr');
        createNode('Nr', 300, 300, 'Nr');
        createLine(nodes.L, nodes.N);
        createLine(nodes.N, nodes.Nr);
        createLine(nodes.L, nodes.Lr);
    }

    resetNodes();

</script>
</body>
</html>
